---
title: "data analysis lab"
author: "Sami Kader-Yettefti"
format: html
code-fold: true
---

# Lab work

The URL to my fork is: 

<https://github.com/kaderrsami/r-101-grade-analysis>

```{r setup1, include=FALSE}
here::i_am("r-101-grade-analysis.Rproj")

library(here)
library(vroom)
library(ggplot2)
library(dplyr)
library(tidyr)
library(knitr)

theme_set(theme_bw())
```

### question 1

```{r setup2}
grades <- vroom(here("grades.csv"))
```

### question 2

```{r}
exam_stats <- grades %>% 
  summarise(
            Min = min(Exam, na.rm = TRUE),
            Max = max(Exam, na.rm = TRUE),
            Median = median(Exam, na.rm = TRUE),
            Mean = mean(Exam, na.rm = TRUE))
```

```{r table1, results='asis'}
kable(exam_stats, caption = "Statistics for Exam Grades")
```

### question 3

```{r}
num_missing_exam <- grades %>%
  filter(is.na(Exam)) %>%
  summarise(Count = n()) %>%
  pull(Count)
```

A total of `r num_missing_exam` students did not take the final exam.

### question 4

```{r bar_exam_grades}
filtered_grades <- grades %>% filter(!is.na(Exam))

ggplot(filtered_grades, aes(x=Exam)) +
  geom_bar() +
  ggtitle("Bar Plot for Exam Grades") +
  xlab("Exam Grades") +
  ylab("Count")
```

### question 5

```{r}
group_counts <- grades %>%
  group_by(Group) %>%
  summarise(Count = n())
```

```{r table2, results='asis'}
kable(group_counts, caption = "Count for Exam Grades")
```

### question 6

```{r bar_count}
ggplot(group_counts, aes(x=Group, y=Count)) +
  geom_bar(stat="identity") +
  ggtitle("Number of Students in Each Group") +
  xlab("Group") +
  ylab("Number of Students") +
  theme(axis.text.x = element_text(angle = 42, hjust = 1))
```

### question 7

Representation of the distribution of the grades at the `Exam` conditioned by the group


```{r facet}
ggplot(filtered_grades, aes(x=Exam)) +
  geom_histogram(binwidth=1) +
  facet_wrap(~Group) +
  ggtitle("Distribution of Exam Grades by Group (Faceted Histogram)") +
  xlab("Exam Grades") +
  ylab("Frequency")
```

An other epresentation of the distribution of the grades at the `Exam` conditioned by the group

```{r box}
ggplot(filtered_grades, aes(x=Group, y=Exam)) +
  geom_boxplot() +
  ggtitle("Distribution of Exam Grades by Group (Boxplot)") +
  xlab("Group") +
  ylab("Exam Grades") +
  theme(axis.text.x = element_text(angle = 42, hjust = 1))
```
# Homework

### question 8

```{r}
missed_exam_counts <- grades %>%
  group_by(Group) %>%
  summarise(Missed_Exam_Count = sum(is.na(Exam)))
```

```{r table3, results='asis'}
knitr::kable(missed_exam_counts, caption = "Number of Students Who Missed the Exam in Each Group")
```

### question 9

```{r missed_exam_count}
ggplot(missed_exam_counts, aes(x=Group, y=Missed_Exam_Count)) +
  geom_col() +
  ggtitle("Number of Students Who Missed the Exam by Group") +
  xlab("Group") +
  ylab("Number of Students") +
  theme(axis.text.x = element_text(angle = 42, hjust = 1))
```

### question 10

```{r}
long_format_grades <- grades %>%
  gather(key = "name", value = "value", -Id, -Group)
```

### question 11

```{r}
missing_grades_count <- long_format_grades %>%
  group_by(Id) %>%
  summarise(Missing_Grades = sum(is.na(value)))
```

### question 12

```{r}
ggplot(missing_grades_count, aes(x=Missing_Grades)) +
  geom_histogram(binwidth=1, fill="blue", color="black") +
  ggtitle("Distribution of Number of Missing Grades Per Student") +
  xlab("Number of Missing Grades") +
  ylab("Number of Students")
```

